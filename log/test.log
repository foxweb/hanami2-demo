# Logfile created on 2022-11-27 03:29:19 +0300 by logger.rb/v1.5.0
[bookshelf] [INFO] [2022-11-27 03:29:19 +0300] GET 200 56µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-11-27 03:35:35 +0300] GET 200 38µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-11-27 03:35:56 +0300] GET 200 29µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-11-27 03:38:09 +0300] GET 200 15ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-11-27 03:39:11 +0300] GET 200 15ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-11-27 03:42:38 +0300] GET 200 15ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-11-27 03:43:11 +0300] GET 200 14ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-11-29 00:44:17 +0300] GET 200 20ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-11-29 00:50:08 +0300] GET 200 15ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-11-29 00:51:37 +0300] GET 200 15ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-11-29 01:08:21 +0300] GET 200 11ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-11-29 01:10:07 +0300] GET 200 14ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-11-29 01:10:57 +0300] GET 200 14ms 127.0.0.1 /books -
[bookshelf] [ERROR] [2022-11-29 01:22:28 +0300] GET 500 0µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
  undefined local variable or method `request' for #<Bookshelf::Actions::Books::Index:0x0000000105e34d78 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x0000000104fe5830 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00000001059180d8 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00000001051751f0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x0000000105e34fa8 @router=#<Hanami::Slice::Router:0x0000000105d77f98 @path_prefix=#<Hanami::Router::Prefix:0x0000000105d77610 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x0000000105d77ea8 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x0000000105d6da98 @notifications=#<Dry::Monitor::Notifications:0x0000000104f6c070 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x0000000104f6cb10 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000105d6d138 @listeners=#<Concurrent::Map:0x0000000105d6d200 entries=3 default_proc=#<Proc:0x0000000104f5d020 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x0000000105d6d4d0 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x0000000105d6db38 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x0000000105d775c0 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x0000000105d77548 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x0000000105d6c238 @slice=Bookshelf::App>, @not_found=#<Proc:0x00000001048f3cc0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x0000000105d76f58 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x0000000105d8db18 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x0000000105d87f38 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x0000000105d8d938 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x0000000105d87060 @root=#<Hanami::Router::Node:0x0000000105d86fc0 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000105d86c78 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000105d8ec70 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000105d87100 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x0000000105d8e9a0 @root=#<Hanami::Router::Node:0x0000000105d8e978 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000105d8e798 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000105d8de10 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000105d8e9c8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x0000000104f1d650 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x0000000105d6da98 @notifications=#<Dry::Monitor::Notifications:0x0000000104f6c070 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x0000000104f6cb10 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000105d6d138 @listeners=#<Concurrent::Map:0x0000000105d6d200 entries=3 default_proc=#<Proc:0x0000000104f5d020 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x0000000105d6d4d0 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x0000000105d6db38 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';\nchild-src 'self';\nconnect-src 'self';\ndefault-src 'none';\nfont-src 'self';\nform-action 'self';\nframe-ancestors 'self';\nframe-src 'self';\nimg-src 'self' https: data:;\nmedia-src 'self';\nobject-src 'none';\nplugin-types application/pdf;\nscript-src 'self';\nstyle-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/Users/foxweb/work/bookshelf>, :public_directory=>"/Users/foxweb/work/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x0000000105dcf7e8 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x0000000105dcf770 @chain=[]>}>>

          halt 422, { errors: request.params.errors }.to_json unless request.params.valid?
                                                                     ^^^^^^^
Did you mean?  require (NameError)
  /Users/foxweb/work/bookshelf/app/actions/books/index.rb:13:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/index/pagination_spec.rb:12:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [ERROR] [2022-11-29 01:22:28 +0300] GET 500 0µs 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
  undefined local variable or method `request' for #<Bookshelf::Actions::Books::Index:0x0000000105f5d010 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x0000000104fe5830 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00000001059180d8 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00000001051751f0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x0000000105f5d218 @router=#<Hanami::Slice::Router:0x0000000105d77f98 @path_prefix=#<Hanami::Router::Prefix:0x0000000105d77610 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x0000000105d77ea8 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x0000000105d6da98 @notifications=#<Dry::Monitor::Notifications:0x0000000104f6c070 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x0000000104f6cb10 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000105d6d138 @listeners=#<Concurrent::Map:0x0000000105d6d200 entries=3 default_proc=#<Proc:0x0000000104f5d020 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x0000000105d6d4d0 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x0000000105d6db38 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x0000000105d775c0 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x0000000105d77548 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x0000000105d6c238 @slice=Bookshelf::App>, @not_found=#<Proc:0x00000001048f3cc0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x0000000105d76f58 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x0000000105d8db18 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x0000000105d87f38 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x0000000105d8d938 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x0000000105d87060 @root=#<Hanami::Router::Node:0x0000000105d86fc0 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000105d86c78 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000105d8ec70 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000105d87100 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x0000000105d8e9a0 @root=#<Hanami::Router::Node:0x0000000105d8e978 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000105d8e798 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000105d8de10 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000105d8e9c8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x0000000104f1d650 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x0000000105d6da98 @notifications=#<Dry::Monitor::Notifications:0x0000000104f6c070 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x0000000104f6cb10 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000105d6d138 @listeners=#<Concurrent::Map:0x0000000105d6d200 entries=3 default_proc=#<Proc:0x0000000104f5d020 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x0000000105d6d4d0 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x0000000105d6db38 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';\nchild-src 'self';\nconnect-src 'self';\ndefault-src 'none';\nfont-src 'self';\nform-action 'self';\nframe-ancestors 'self';\nframe-src 'self';\nimg-src 'self' https: data:;\nmedia-src 'self';\nobject-src 'none';\nplugin-types application/pdf;\nscript-src 'self';\nstyle-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/Users/foxweb/work/bookshelf>, :public_directory=>"/Users/foxweb/work/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x0000000105dcf7e8 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x0000000105dcf770 @chain=[]>}>>

          halt 422, { errors: request.params.errors }.to_json unless request.params.valid?
                                                                     ^^^^^^^
Did you mean?  require (NameError)
  /Users/foxweb/work/bookshelf/app/actions/books/index.rb:13:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/index/pagination_spec.rb:28:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [ERROR] [2022-11-29 01:23:16 +0300] GET 500 0µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
  undefined local variable or method `request' for #<Bookshelf::Actions::Books::Index:0x0000000107aeea18 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x000000010751b780 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x0000000107428ad0 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00000001070a16f0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x0000000107aeec48 @router=#<Hanami::Slice::Router:0x000000010791dc70 @path_prefix=#<Hanami::Router::Prefix:0x000000010791d2e8 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x000000010791db80 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x000000010791f750 @notifications=#<Dry::Monitor::Notifications:0x000000010724b190 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00000001071308f0 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x000000010791edf0 @listeners=#<Concurrent::Map:0x000000010791eeb8 entries=3 default_proc=#<Proc:0x0000000107162df0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x000000010791f188 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x000000010791f7f0 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x000000010791d298 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x000000010791d220 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x000000010791def0 @slice=Bookshelf::App>, @not_found=#<Proc:0x0000000107171968 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x000000010791cc30 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x000000010797f7b8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x000000010796dc20 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x000000010797f5d8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x000000010796cd48 @root=#<Hanami::Router::Node:0x000000010796cca8 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x000000010796c960 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000107974930 @variable=nil, @fixed=nil, @to=#<Proc:0x000000010796cde8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x0000000107974660 @root=#<Hanami::Router::Node:0x0000000107974638 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000107974458 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x000000010797fab0 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000107974688 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00000001071287e0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x000000010791f750 @notifications=#<Dry::Monitor::Notifications:0x000000010724b190 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00000001071308f0 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x000000010791edf0 @listeners=#<Concurrent::Map:0x000000010791eeb8 entries=3 default_proc=#<Proc:0x0000000107162df0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x000000010791f188 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x000000010791f7f0 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';\nchild-src 'self';\nconnect-src 'self';\ndefault-src 'none';\nfont-src 'self';\nform-action 'self';\nframe-ancestors 'self';\nframe-src 'self';\nimg-src 'self' https: data:;\nmedia-src 'self';\nobject-src 'none';\nplugin-types application/pdf;\nscript-src 'self';\nstyle-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/Users/foxweb/work/bookshelf>, :public_directory=>"/Users/foxweb/work/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x0000000107a7d4d0 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x0000000107a7d458 @chain=[]>}>>

          halt 422, { errors: request.params.errors }.to_json unless request.params.valid?
                                                                     ^^^^^^^
Did you mean?  require (NameError)
  /Users/foxweb/work/bookshelf/app/actions/books/index.rb:13:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/index/pagination_spec.rb:12:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [ERROR] [2022-11-29 01:23:16 +0300] GET 500 0µs 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
  undefined local variable or method `request' for #<Bookshelf::Actions::Books::Index:0x0000000107e32d28 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x000000010751b780 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x0000000107428ad0 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00000001070a16f0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x0000000107e32f30 @router=#<Hanami::Slice::Router:0x000000010791dc70 @path_prefix=#<Hanami::Router::Prefix:0x000000010791d2e8 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x000000010791db80 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x000000010791f750 @notifications=#<Dry::Monitor::Notifications:0x000000010724b190 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00000001071308f0 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x000000010791edf0 @listeners=#<Concurrent::Map:0x000000010791eeb8 entries=3 default_proc=#<Proc:0x0000000107162df0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x000000010791f188 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x000000010791f7f0 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x000000010791d298 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x000000010791d220 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x000000010791def0 @slice=Bookshelf::App>, @not_found=#<Proc:0x0000000107171968 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x000000010791cc30 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x000000010797f7b8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x000000010796dc20 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x000000010797f5d8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x000000010796cd48 @root=#<Hanami::Router::Node:0x000000010796cca8 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x000000010796c960 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000107974930 @variable=nil, @fixed=nil, @to=#<Proc:0x000000010796cde8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x0000000107974660 @root=#<Hanami::Router::Node:0x0000000107974638 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000107974458 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x000000010797fab0 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000107974688 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00000001071287e0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x000000010791f750 @notifications=#<Dry::Monitor::Notifications:0x000000010724b190 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00000001071308f0 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x000000010791edf0 @listeners=#<Concurrent::Map:0x000000010791eeb8 entries=3 default_proc=#<Proc:0x0000000107162df0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x000000010791f188 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x000000010791f7f0 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';\nchild-src 'self';\nconnect-src 'self';\ndefault-src 'none';\nfont-src 'self';\nform-action 'self';\nframe-ancestors 'self';\nframe-src 'self';\nimg-src 'self' https: data:;\nmedia-src 'self';\nobject-src 'none';\nplugin-types application/pdf;\nscript-src 'self';\nstyle-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/Users/foxweb/work/bookshelf>, :public_directory=>"/Users/foxweb/work/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x0000000107a7d4d0 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x0000000107a7d458 @chain=[]>}>>

          halt 422, { errors: request.params.errors }.to_json unless request.params.valid?
                                                                     ^^^^^^^
Did you mean?  require (NameError)
  /Users/foxweb/work/bookshelf/app/actions/books/index.rb:13:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/index/pagination_spec.rb:28:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [ERROR] [2022-11-29 01:23:36 +0300] GET 500 0µs 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
  undefined local variable or method `request' for #<Bookshelf::Actions::Books::Index:0x00000001053c6a30 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x0000000104df3720 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x0000000104cfa350 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x0000000104980b70 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x00000001053c6c60 @router=#<Hanami::Slice::Router:0x00000001051f5c60 @path_prefix=#<Hanami::Router::Prefix:0x00000001051f52d8 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00000001051f5b70 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00000001051f7740 @notifications=#<Dry::Monitor::Notifications:0x0000000104b230b8 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x0000000104a10298 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00000001051f6de0 @listeners=#<Concurrent::Map:0x00000001051f6ea8 entries=3 default_proc=#<Proc:0x0000000104a42ae0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00000001051f7178 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00000001051f77e0 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00000001051f5288 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00000001051f5210 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00000001051f5ee0 @slice=Bookshelf::App>, @not_found=#<Proc:0x0000000104a49a48 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00000001051f4c20 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00000001052577d0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x0000000105245c10 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00000001052575f0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x0000000105244d38 @root=#<Hanami::Router::Node:0x0000000105244c98 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000105244950 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x000000010524c948 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000105244dd8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x000000010524c678 @root=#<Hanami::Router::Node:0x000000010524c650 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x000000010524c470 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000105257ac8 @variable=nil, @fixed=nil, @to=#<Proc:0x000000010524c6a0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x0000000104a097e0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00000001051f7740 @notifications=#<Dry::Monitor::Notifications:0x0000000104b230b8 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x0000000104a10298 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00000001051f6de0 @listeners=#<Concurrent::Map:0x00000001051f6ea8 entries=3 default_proc=#<Proc:0x0000000104a42ae0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00000001051f7178 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00000001051f77e0 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';\nchild-src 'self';\nconnect-src 'self';\ndefault-src 'none';\nfont-src 'self';\nform-action 'self';\nframe-ancestors 'self';\nframe-src 'self';\nimg-src 'self' https: data:;\nmedia-src 'self';\nobject-src 'none';\nplugin-types application/pdf;\nscript-src 'self';\nstyle-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/Users/foxweb/work/bookshelf>, :public_directory=>"/Users/foxweb/work/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00000001053554c0 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x0000000105355448 @chain=[]>}>>

          halt 422, { errors: request.params.errors }.to_json unless request.params.valid?
                                                                     ^^^^^^^
Did you mean?  require (NameError)
  /Users/foxweb/work/bookshelf/app/actions/books/index.rb:13:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/index/pagination_spec.rb:28:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [ERROR] [2022-11-29 01:23:36 +0300] GET 500 0µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
  undefined local variable or method `request' for #<Bookshelf::Actions::Books::Index:0x000000010574ab48 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x0000000104df3720 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x0000000104cfa350 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x0000000104980b70 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x000000010574ad50 @router=#<Hanami::Slice::Router:0x00000001051f5c60 @path_prefix=#<Hanami::Router::Prefix:0x00000001051f52d8 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x00000001051f5b70 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x00000001051f7740 @notifications=#<Dry::Monitor::Notifications:0x0000000104b230b8 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x0000000104a10298 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00000001051f6de0 @listeners=#<Concurrent::Map:0x00000001051f6ea8 entries=3 default_proc=#<Proc:0x0000000104a42ae0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00000001051f7178 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00000001051f77e0 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00000001051f5288 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x00000001051f5210 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x00000001051f5ee0 @slice=Bookshelf::App>, @not_found=#<Proc:0x0000000104a49a48 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x00000001051f4c20 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00000001052577d0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x0000000105245c10 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x00000001052575f0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x0000000105244d38 @root=#<Hanami::Router::Node:0x0000000105244c98 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000105244950 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x000000010524c948 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000105244dd8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x000000010524c678 @root=#<Hanami::Router::Node:0x000000010524c650 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x000000010524c470 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000105257ac8 @variable=nil, @fixed=nil, @to=#<Proc:0x000000010524c6a0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x0000000104a097e0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x00000001051f7740 @notifications=#<Dry::Monitor::Notifications:0x0000000104b230b8 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x0000000104a10298 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x00000001051f6de0 @listeners=#<Concurrent::Map:0x00000001051f6ea8 entries=3 default_proc=#<Proc:0x0000000104a42ae0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x00000001051f7178 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x00000001051f77e0 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';\nchild-src 'self';\nconnect-src 'self';\ndefault-src 'none';\nfont-src 'self';\nform-action 'self';\nframe-ancestors 'self';\nframe-src 'self';\nimg-src 'self' https: data:;\nmedia-src 'self';\nobject-src 'none';\nplugin-types application/pdf;\nscript-src 'self';\nstyle-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/Users/foxweb/work/bookshelf>, :public_directory=>"/Users/foxweb/work/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00000001053554c0 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x0000000105355448 @chain=[]>}>>

          halt 422, { errors: request.params.errors }.to_json unless request.params.valid?
                                                                     ^^^^^^^
Did you mean?  require (NameError)
  /Users/foxweb/work/bookshelf/app/actions/books/index.rb:13:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/index/pagination_spec.rb:12:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [ERROR] [2022-11-29 01:23:45 +0300] GET 500 0µs 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
  undefined local variable or method `request' for #<Bookshelf::Actions::Books::Index:0x0000000105df17d0 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x0000000105363048 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00000001059d4b48 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00000001054e9d40 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x0000000105df1a00 @router=#<Hanami::Slice::Router:0x0000000105d28a10 @path_prefix=#<Hanami::Router::Prefix:0x0000000105d28088 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x0000000105d28920 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x0000000105d2a4f0 @notifications=#<Dry::Monitor::Notifications:0x0000000105332d80 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x0000000105333820 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000105d29b90 @listeners=#<Concurrent::Map:0x0000000105d29c58 entries=3 default_proc=#<Proc:0x0000000105323d08 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x0000000105d29f28 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x0000000105d2a590 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x0000000105d28038 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x0000000105d33fa0 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x0000000105d28c90 @slice=Bookshelf::App>, @not_found=#<Proc:0x000000010506ad78 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x0000000105d339b0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x0000000105d4a570 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x0000000105d389d8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x0000000105d4a390 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x0000000105d43ab8 @root=#<Hanami::Router::Node:0x0000000105d43a18 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000105d436d0 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000105d4b6c8 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000105d43b58 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x0000000105d4b3f8 @root=#<Hanami::Router::Node:0x0000000105d4b3d0 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000105d4b1f0 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000105d4a868 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000105d4b420 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00000001052d8380 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x0000000105d2a4f0 @notifications=#<Dry::Monitor::Notifications:0x0000000105332d80 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x0000000105333820 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000105d29b90 @listeners=#<Concurrent::Map:0x0000000105d29c58 entries=3 default_proc=#<Proc:0x0000000105323d08 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x0000000105d29f28 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x0000000105d2a590 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';\nchild-src 'self';\nconnect-src 'self';\ndefault-src 'none';\nfont-src 'self';\nform-action 'self';\nframe-ancestors 'self';\nframe-src 'self';\nimg-src 'self' https: data:;\nmedia-src 'self';\nobject-src 'none';\nplugin-types application/pdf;\nscript-src 'self';\nstyle-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/Users/foxweb/work/bookshelf>, :public_directory=>"/Users/foxweb/work/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x0000000105d80288 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x0000000105d80210 @chain=[]>}>>

          halt 422, { errors: request.params.errors }.to_json # unless request.params.valid?
                              ^^^^^^^
Did you mean?  require (NameError)
  /Users/foxweb/work/bookshelf/app/actions/books/index.rb:13:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/index/pagination_spec.rb:12:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [ERROR] [2022-11-29 01:23:45 +0300] GET 500 0µs 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
  undefined local variable or method `request' for #<Bookshelf::Actions::Books::Index:0x0000000105f1a800 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x0000000105363048 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00000001059d4b48 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00000001054e9d40 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x0000000105f1aa08 @router=#<Hanami::Slice::Router:0x0000000105d28a10 @path_prefix=#<Hanami::Router::Prefix:0x0000000105d28088 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x0000000105d28920 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x0000000105d2a4f0 @notifications=#<Dry::Monitor::Notifications:0x0000000105332d80 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x0000000105333820 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000105d29b90 @listeners=#<Concurrent::Map:0x0000000105d29c58 entries=3 default_proc=#<Proc:0x0000000105323d08 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x0000000105d29f28 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x0000000105d2a590 @unit=:microsecond>>, [], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x0000000105d28038 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x0000000105d33fa0 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x0000000105d28c90 @slice=Bookshelf::App>, @not_found=#<Proc:0x000000010506ad78 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x0000000105d339b0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x0000000105d4a570 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x0000000105d389d8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x0000000105d4a390 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x0000000105d43ab8 @root=#<Hanami::Router::Node:0x0000000105d43a18 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000105d436d0 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000105d4b6c8 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000105d43b58 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x0000000105d4b3f8 @root=#<Hanami::Router::Node:0x0000000105d4b3d0 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000105d4b1f0 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000105d4a868 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000105d4b420 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00000001052d8380 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x0000000105d2a4f0 @notifications=#<Dry::Monitor::Notifications:0x0000000105332d80 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x0000000105333820 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000105d29b90 @listeners=#<Concurrent::Map:0x0000000105d29c58 entries=3 default_proc=#<Proc:0x0000000105323d08 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x0000000105d29f28 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x0000000105d2a590 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';\nchild-src 'self';\nconnect-src 'self';\ndefault-src 'none';\nfont-src 'self';\nform-action 'self';\nframe-ancestors 'self';\nframe-src 'self';\nimg-src 'self' https: data:;\nmedia-src 'self';\nobject-src 'none';\nplugin-types application/pdf;\nscript-src 'self';\nstyle-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/Users/foxweb/work/bookshelf>, :public_directory=>"/Users/foxweb/work/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x0000000105d80288 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x0000000105d80210 @chain=[]>}>>

          halt 422, { errors: request.params.errors }.to_json # unless request.params.valid?
                              ^^^^^^^
Did you mean?  require (NameError)
  /Users/foxweb/work/bookshelf/app/actions/books/index.rb:13:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/index/pagination_spec.rb:28:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [INFO] [2022-11-29 01:25:25 +0300] GET 404 23µs 127.0.0.1 /books/1 -
[bookshelf] [INFO] [2022-11-29 01:25:25 +0300] GET 404 15µs 127.0.0.1 /books/1 -
[bookshelf] [INFO] [2022-11-29 01:27:01 +0300] GET 404 19ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-11-29 01:27:01 +0300] GET 200 898µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-11-29 01:30:03 +0300] GET 200 20ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [ERROR] [2022-11-29 01:30:03 +0300] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /Users/foxweb/work/bookshelf/app/actions/books/show.rb:16:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [ERROR] [2022-11-29 01:32:02 +0300] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /Users/foxweb/work/bookshelf/app/actions/books/show.rb:16:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [INFO] [2022-11-29 01:32:02 +0300] GET 404 19ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-11-29 01:32:02 +0300] GET 200 845µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-11-29 01:32:18 +0300] GET 200 19ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [ERROR] [2022-11-29 01:32:18 +0300] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /Users/foxweb/work/bookshelf/app/actions/books/show.rb:16:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [INFO] [2022-11-29 01:32:34 +0300] GET 200 16ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [ERROR] [2022-11-29 01:32:34 +0300] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /Users/foxweb/work/bookshelf/app/actions/books/show.rb:16:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [INFO] [2022-11-29 01:32:34 +0300] GET 404 1ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [ERROR] [2022-11-29 01:37:50 +0300] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /Users/foxweb/work/bookshelf/app/actions/books/show.rb:14:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [INFO] [2022-11-29 01:37:50 +0300] GET 404 20ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-11-29 01:37:51 +0300] GET 200 965µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-11-29 01:43:10 +0300] POST 201 41ms 127.0.0.1 /books -
  {:book=>{:title=>"Practical Object-Oriented Design in Ruby", :author=>"Sandi Metz"}}
[bookshelf] [INFO] [2022-11-29 01:43:10 +0300] POST 422 3ms 127.0.0.1 /books -
  {:book=>{:title=>nil}}
[bookshelf] [ERROR] [2022-11-29 01:43:15 +0300] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /Users/foxweb/work/bookshelf/app/actions/books/show.rb:14:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [INFO] [2022-11-29 01:43:15 +0300] GET 404 17ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-11-29 01:43:15 +0300] GET 200 964µs 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [ERROR] [2022-11-29 01:43:21 +0300] GET 500 0µs 127.0.0.1 /books -
  undefined local variable or method `request' for #<Bookshelf::Actions::Books::Index:0x0000000105fb2308 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x00000001054f8020 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x0000000105ba7c90 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x00000001056ba390 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x0000000105fb2538 @router=#<Hanami::Slice::Router:0x0000000105ee1898 @path_prefix=#<Hanami::Router::Prefix:0x0000000105ee0f10 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x0000000105ee17a8 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x0000000105ee3378 @notifications=#<Dry::Monitor::Notifications:0x00000001055028b8 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x0000000105503380 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000105ee2a18 @listeners=#<Concurrent::Map:0x0000000105ee2ae0 entries=3 default_proc=#<Proc:0x00000001054f38e0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x0000000105ee2db0 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x0000000105ee3418 @unit=:microsecond>>, [], nil], [Hanami::Middleware::BodyParser, [:json], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x0000000105ee0ec0 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x0000000105ee0e48 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x0000000105ee1b18 @slice=Bookshelf::App>, @not_found=#<Proc:0x00000001052cbef0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x0000000105ee0858 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x0000000105f033f8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x0000000105ef1860 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x0000000105f03218 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "POST"=>{"/books"=>#<Proc:0x0000000105f01328 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x0000000105ef0988 @root=#<Hanami::Router::Node:0x0000000105ef08e8 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000105ef05a0 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000105ef8570 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000105ef0a28 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>, "books"=>#<Hanami::Router::Node:0x0000000105f02d68 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000105f023b8 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000105f02f20 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x0000000105ef82a0 @root=#<Hanami::Router::Node:0x0000000105ef8278 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000105ef8098 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000105f036f0 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000105ef82c8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>, "books"=>#<Hanami::Router::Node:0x0000000105f02020 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000105f01698 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000105f021d8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x00000001054b3f88 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x0000000105ee3378 @notifications=#<Dry::Monitor::Notifications:0x00000001055028b8 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x0000000105503380 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000105ee2a18 @listeners=#<Concurrent::Map:0x0000000105ee2ae0 entries=3 default_proc=#<Proc:0x00000001054f38e0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x0000000105ee2db0 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x0000000105ee3418 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{ROM::TupleCountMismatchError=>:handle_not_found}, :formats=>#<Hanami::Action::Config::Formats values=[] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';\nchild-src 'self';\nconnect-src 'self';\ndefault-src 'none';\nfont-src 'self';\nform-action 'self';\nframe-ancestors 'self';\nframe-src 'self';\nimg-src 'self' https: data:;\nmedia-src 'self';\nobject-src 'none';\nplugin-types application/pdf;\nscript-src 'self';\nstyle-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/Users/foxweb/work/bookshelf>, :public_directory=>"/Users/foxweb/work/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x0000000105f40d98 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x0000000105f40d20 @chain=[]>}>>

          halt 422, { errors: request.params.errors }.to_json # unless request.params.valid?
                              ^^^^^^^
Did you mean?  require (NameError)
  /Users/foxweb/work/bookshelf/app/actions/books/index.rb:13:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/index_spec.rb:10:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [INFO] [2022-11-29 01:43:46 +0300] GET 200 19ms 127.0.0.1 /books -
[bookshelf] [ERROR] [2022-11-29 01:44:45 +0300] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /Users/foxweb/work/bookshelf/app/actions/books/show.rb:14:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [INFO] [2022-11-29 01:44:45 +0300] GET 404 17ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-11-29 01:44:45 +0300] GET 200 1ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-11-29 01:44:45 +0300] GET 200 718µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-11-29 01:44:45 +0300] POST 422 1ms 127.0.0.1 /books -
  {:book=>{:title=>nil}}
[bookshelf] [INFO] [2022-11-29 01:44:45 +0300] POST 201 2ms 127.0.0.1 /books -
  {:book=>{:title=>"Practical Object-Oriented Design in Ruby", :author=>"Sandi Metz"}}
[bookshelf] [INFO] [2022-11-29 01:44:45 +0300] GET 200 1ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-11-29 01:44:45 +0300] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-11-29 01:44:45 +0300] GET 200 1ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-11-29 01:51:04 +0300] GET 200 1ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-11-29 01:51:04 +0300] GET 200 2ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [ERROR] [2022-11-29 01:51:04 +0300] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /Users/foxweb/work/bookshelf/app/actions/books/show.rb:14:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [INFO] [2022-11-29 01:51:04 +0300] GET 404 1ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-11-29 01:51:04 +0300] POST 201 3ms 127.0.0.1 /books -
  {:book=>{:title=>"Practical Object-Oriented Design in Ruby", :author=>"Sandi Metz"}}
[bookshelf] [INFO] [2022-11-29 01:51:04 +0300] POST 422 3ms 127.0.0.1 /books -
  {:book=>{:title=>nil}}
[bookshelf] [INFO] [2022-11-29 01:51:04 +0300] GET 422 2ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-11-29 01:51:04 +0300] GET 200 1ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-11-29 01:51:04 +0300] GET 200 986µs 127.0.0.1 /books -
[bookshelf] [ERROR] [2022-11-29 01:52:15 +0300] GET 500 0µs   -
  undefined method `pry' for #<Binding:0x0000000109d912a0>

          binding.pry
                 ^^^^ (NoMethodError)
  /Users/foxweb/work/bookshelf/app/actions/books/create.rb:17:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/work/bookshelf/spec/actions/books/create_spec.rb:7:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:624:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [ERROR] [2022-11-29 01:52:15 +0300] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /Users/foxweb/work/bookshelf/app/actions/books/show.rb:14:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [INFO] [2022-11-29 01:52:15 +0300] GET 404 15ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-11-29 01:52:15 +0300] GET 200 1ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-11-29 01:52:15 +0300] GET 200 619µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-11-29 01:52:15 +0300] GET 200 8ms 127.0.0.1 /books -
[bookshelf] [ERROR] [2022-11-29 01:52:15 +0300] POST 500 0µs 127.0.0.1 /books -
  {:book=>{:title=>"Practical Object-Oriented Design in Ruby", :author=>"Sandi Metz"}}
  undefined method `pry' for #<Binding:0x0000000108d984c0>

          binding.pry
                 ^^^^ (NoMethodError)
  /Users/foxweb/work/bookshelf/app/actions/books/create.rb:17:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:52:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `post'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `post'
  /Users/foxweb/work/bookshelf/spec/requests/books/create_spec.rb:12:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [ERROR] [2022-11-29 01:52:15 +0300] POST 500 0µs 127.0.0.1 /books -
  {:book=>{:title=>nil}}
  undefined method `pry' for #<Binding:0x0000000109091078>

          binding.pry
                 ^^^^ (NoMethodError)
  /Users/foxweb/work/bookshelf/app/actions/books/create.rb:17:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:52:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `post'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `post'
  /Users/foxweb/work/bookshelf/spec/requests/books/create_spec.rb:24:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [INFO] [2022-11-29 01:52:15 +0300] GET 422 1ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-11-29 01:52:15 +0300] GET 200 1ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [ERROR] [2022-11-29 01:53:10 +0300] GET 500 0µs   -
  undefined method `pry!' for #<Binding:0x000000010782b998>

          binding.pry!
                 ^^^^^ (NoMethodError)
  /Users/foxweb/work/bookshelf/app/actions/books/create.rb:17:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/work/bookshelf/spec/actions/books/create_spec.rb:7:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:624:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [ERROR] [2022-11-29 01:53:17 +0300] GET 500 0µs   -
  undefined method `pry' for #<Binding:0x000000010577b720>

          binding.pry
                 ^^^^ (NoMethodError)
  /Users/foxweb/work/bookshelf/app/actions/books/create.rb:17:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/work/bookshelf/spec/actions/books/create_spec.rb:7:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:624:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [ERROR] [2022-11-29 01:56:21 +0300] GET 500 0µs   -
  undefined method `pry' for #<Binding:0x0000000107892da0>

          binding.pry
                 ^^^^ (NoMethodError)
  /Users/foxweb/work/bookshelf/app/actions/books/create.rb:17:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/work/bookshelf/spec/actions/books/create_spec.rb:7:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:624:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [ERROR] [2022-11-29 02:00:17 +0300] GET 500 0µs   -
  undefined method `ap' for #<Bookshelf::Actions::Books::Create:0x0000000107638320 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x0000000106f002d8 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x00000001070b8e90 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x0000000106d032a0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x0000000107638550 @router=#<Hanami::Slice::Router:0x0000000107618c78 @path_prefix=#<Hanami::Router::Prefix:0x0000000107618340 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x0000000107618b88 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x000000010761a758 @notifications=#<Dry::Monitor::Notifications:0x0000000106c2b710 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x0000000106c201f8 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000107619df8 @listeners=#<Concurrent::Map:0x0000000107619ec0 entries=2 default_proc=#<Proc:0x0000000106c10758 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x000000010761a190 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x000000010761a7f8 @unit=:microsecond>>, [], nil], [Hanami::Middleware::BodyParser, [:json], nil], [Hanami::Middleware::BodyParser, [[{:json=>[]}]], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x00000001076182f0 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x0000000107618278 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x0000000107618ef8 @slice=Bookshelf::App>, @not_found=#<Proc:0x0000000106971b50 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x0000000107623c68 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x000000010763a850 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x0000000107628c90 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x000000010763a670 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "POST"=>{"/books"=>#<Proc:0x0000000107638780 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x0000000107633d98 @root=#<Hanami::Router::Node:0x0000000107633cf8 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x00000001076339b0 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x000000010763b9a8 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000107633e38 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>, "books"=>#<Hanami::Router::Node:0x000000010763a1c0 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000107639810 @variable=nil, @fixed=nil, @to=#<Proc:0x000000010763a378 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x000000010763b6d8 @root=#<Hanami::Router::Node:0x000000010763b6b0 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x000000010763b4d0 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x000000010763ab48 @variable=nil, @fixed=nil, @to=#<Proc:0x000000010763b700 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>, "books"=>#<Hanami::Router::Node:0x0000000107639478 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000107638af0 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000107639630 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x0000000106b2a1e0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x000000010761a758 @notifications=#<Dry::Monitor::Notifications:0x0000000106c2b710 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x0000000106c201f8 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000107619df8 @listeners=#<Concurrent::Map:0x0000000107619ec0 entries=2 default_proc=#<Proc:0x0000000106c10758 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x000000010761a190 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x000000010761a7f8 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{ROM::TupleCountMismatchError=>:handle_not_found}, :formats=>#<Hanami::Action::Config::Formats values=[:json] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';\nchild-src 'self';\nconnect-src 'self';\ndefault-src 'none';\nfont-src 'self';\nform-action 'self';\nframe-ancestors 'self';\nframe-src 'self';\nimg-src 'self' https: data:;\nmedia-src 'self';\nobject-src 'none';\nplugin-types application/pdf;\nscript-src 'self';\nstyle-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/Users/foxweb/work/bookshelf>, :public_directory=>"/Users/foxweb/work/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00000001070d8f88 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00000001070d8f10 @chain=[]>}>>

          ap request.params
          ^^ (NoMethodError)
  /Users/foxweb/work/bookshelf/app/actions/books/create.rb:17:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/work/bookshelf/spec/actions/books/create_spec.rb:7:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:624:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [INFO] [2022-11-29 02:05:49 +0300] GET 200 14ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-11-29 02:05:49 +0300] GET 200 3ms 127.0.0.1 /books/3 -
  {:id=>"3"}
[bookshelf] [ERROR] [2022-11-29 02:05:49 +0300] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /Users/foxweb/work/bookshelf/app/actions/books/show.rb:14:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [INFO] [2022-11-29 02:05:49 +0300] GET 404 1ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-11-29 02:05:49 +0300] GET 422 5ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-11-29 02:05:49 +0300] GET 200 1ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-11-29 02:05:49 +0300] GET 200 644µs 127.0.0.1 / -
[bookshelf] [ERROR] [2022-11-29 02:05:49 +0300] GET 500 0µs   -
  undefined method `ap' for #<Bookshelf::Actions::Books::Create:0x0000000107ed6810 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x0000000107327eb0 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x0000000107237e88 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x0000000106ce6d80 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x0000000107ed6a18 @router=#<Hanami::Slice::Router:0x0000000107bdd5c8 @path_prefix=#<Hanami::Router::Prefix:0x0000000107bdcc90 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x0000000107bdd4d8 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x0000000107bdf0a8 @notifications=#<Dry::Monitor::Notifications:0x00000001070ff020 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00000001070ffae8 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000107bde748 @listeners=#<Concurrent::Map:0x0000000107bde810 entries=3 default_proc=#<Proc:0x000000010709f5a8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x0000000107bdeae0 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x0000000107bdf148 @unit=:microsecond>>, [], nil], [Hanami::Middleware::BodyParser, [:json], nil], [Hanami::Middleware::BodyParser, [[{:json=>[]}]], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x0000000107bdcc40 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x0000000107bdcbc8 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x0000000107bdd848 @slice=Bookshelf::App>, @not_found=#<Proc:0x00000001070176d0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x0000000107bdc5d8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x0000000107bff1a0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x0000000107bed608 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x0000000107bfefc0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "POST"=>{"/books"=>#<Proc:0x0000000107bfd0d0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x0000000107bec730 @root=#<Hanami::Router::Node:0x0000000107bec690 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000107bec348 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000107bf4318 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000107bec7d0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>, "books"=>#<Hanami::Router::Node:0x0000000107bfeb10 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000107bfe160 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000107bfecc8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x0000000107bf4048 @root=#<Hanami::Router::Node:0x0000000107bf4020 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000107bffe20 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000107bff498 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000107bf4070 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>, "books"=>#<Hanami::Router::Node:0x0000000107bfddc8 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000107bfd440 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000107bfdf80 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x0000000107075a00 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x0000000107bdf0a8 @notifications=#<Dry::Monitor::Notifications:0x00000001070ff020 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00000001070ffae8 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000107bde748 @listeners=#<Concurrent::Map:0x0000000107bde810 entries=3 default_proc=#<Proc:0x000000010709f5a8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x0000000107bdeae0 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x0000000107bdf148 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{ROM::TupleCountMismatchError=>:handle_not_found}, :formats=>#<Hanami::Action::Config::Formats values=[:json] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';\nchild-src 'self';\nconnect-src 'self';\ndefault-src 'none';\nfont-src 'self';\nform-action 'self';\nframe-ancestors 'self';\nframe-src 'self';\nimg-src 'self' https: data:;\nmedia-src 'self';\nobject-src 'none';\nplugin-types application/pdf;\nscript-src 'self';\nstyle-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/Users/foxweb/work/bookshelf>, :public_directory=>"/Users/foxweb/work/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00000001072dc168 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00000001072d7e38 @chain=[]>}>>

          ap request.params
          ^^ (NoMethodError)
  /Users/foxweb/work/bookshelf/app/actions/books/create.rb:17:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/work/bookshelf/spec/actions/books/create_spec.rb:7:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:624:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [ERROR] [2022-11-29 02:05:49 +0300] POST 500 0µs 127.0.0.1 /books -
  {:book=>{:title=>"Practical Object-Oriented Design in Ruby", :author=>"Sandi Metz"}}
  undefined method `ap' for #<Bookshelf::Actions::Books::Create:0x0000000107f3cca0 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x0000000107327eb0 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x0000000107237e88 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x0000000106ce6d80 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x0000000107f3cea8 @router=#<Hanami::Slice::Router:0x0000000107bdd5c8 @path_prefix=#<Hanami::Router::Prefix:0x0000000107bdcc90 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x0000000107bdd4d8 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x0000000107bdf0a8 @notifications=#<Dry::Monitor::Notifications:0x00000001070ff020 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00000001070ffae8 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000107bde748 @listeners=#<Concurrent::Map:0x0000000107bde810 entries=3 default_proc=#<Proc:0x000000010709f5a8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x0000000107bdeae0 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x0000000107bdf148 @unit=:microsecond>>, [], nil], [Hanami::Middleware::BodyParser, [:json], nil], [Hanami::Middleware::BodyParser, [[{:json=>[]}]], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x0000000107bdcc40 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x0000000107bdcbc8 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x0000000107bdd848 @slice=Bookshelf::App>, @not_found=#<Proc:0x00000001070176d0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x0000000107bdc5d8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x0000000107bff1a0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x0000000107bed608 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x0000000107bfefc0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "POST"=>{"/books"=>#<Proc:0x0000000107bfd0d0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x0000000107bec730 @root=#<Hanami::Router::Node:0x0000000107bec690 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000107bec348 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000107bf4318 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000107bec7d0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>, "books"=>#<Hanami::Router::Node:0x0000000107bfeb10 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000107bfe160 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000107bfecc8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x0000000107bf4048 @root=#<Hanami::Router::Node:0x0000000107bf4020 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000107bffe20 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000107bff498 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000107bf4070 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>, "books"=>#<Hanami::Router::Node:0x0000000107bfddc8 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000107bfd440 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000107bfdf80 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x0000000107075a00 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x0000000107bdf0a8 @notifications=#<Dry::Monitor::Notifications:0x00000001070ff020 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00000001070ffae8 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000107bde748 @listeners=#<Concurrent::Map:0x0000000107bde810 entries=3 default_proc=#<Proc:0x000000010709f5a8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x0000000107bdeae0 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x0000000107bdf148 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{ROM::TupleCountMismatchError=>:handle_not_found}, :formats=>#<Hanami::Action::Config::Formats values=[:json] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';\nchild-src 'self';\nconnect-src 'self';\ndefault-src 'none';\nfont-src 'self';\nform-action 'self';\nframe-ancestors 'self';\nframe-src 'self';\nimg-src 'self' https: data:;\nmedia-src 'self';\nobject-src 'none';\nplugin-types application/pdf;\nscript-src 'self';\nstyle-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/Users/foxweb/work/bookshelf>, :public_directory=>"/Users/foxweb/work/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00000001072dc168 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00000001072d7e38 @chain=[]>}>>

          ap request.params
          ^^ (NoMethodError)
  /Users/foxweb/work/bookshelf/app/actions/books/create.rb:17:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:52:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:52:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `post'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `post'
  /Users/foxweb/work/bookshelf/spec/requests/books/create_spec.rb:12:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [ERROR] [2022-11-29 02:05:49 +0300] POST 500 0µs 127.0.0.1 /books -
  {:book=>{:title=>nil}}
  undefined method `ap' for #<Bookshelf::Actions::Books::Create:0x0000000107fae8a0 @rom=#<ROM::Container gateways={:default=>#<ROM::SQL::Gateway:0x0000000107327eb0 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @database_type=:postgres, @options={}, @migrator=#<ROM::SQL::Migration::Migrator:0x0000000107237e88 @connection=#<Sequel::Postgres::Database: "postgres://postgres:postgres@localhost:5432/bookshelf_test">, @path="db/migrate", @inferrer=#<ROM::SQL::Schema::Inferrer options={:attr_class=>ROM::SQL::Attribute, :enabled=>true, :attributes_inferrer=>#<Proc:0x0000000106ce6d80 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-sql-3.6.1/lib/rom/sql/schema/inferrer.rb:16 (lambda)>, :silent=>true, :raise_on_error=>false}>>>} relations=#<ROM::RelationRegistry elements={:books=>#<Bookshelf::Persistence::Relations::Books name=ROM::Relation::Name(books) dataset=#<Sequel::Postgres::Dataset: "SELECT \"books\".\"id\", \"books\".\"title\", \"books\".\"author\" FROM \"books\" ORDER BY \"books\".\"id\"">>}> mappers=#<ROM::Registry elements={}> commands=#<ROM::Registry elements={:books=>#<ROM::CommandRegistry elements={}>}>>, @view=nil, @view_context=nil, @routes=#<Hanami::Slice::RoutesHelper:0x0000000107faeaa8 @router=#<Hanami::Slice::Router:0x0000000107bdd5c8 @path_prefix=#<Hanami::Router::Prefix:0x0000000107bdcc90 @prefix="/">, @middleware_stack=#<Hanami::Slice::Routing::Middleware::Stack:0x0000000107bdd4d8 @stack={"/"=>[[#<Dry::Monitor::Rack::Middleware:0x0000000107bdf0a8 @notifications=#<Dry::Monitor::Notifications:0x00000001070ff020 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00000001070ffae8 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000107bde748 @listeners=#<Concurrent::Map:0x0000000107bde810 entries=3 default_proc=#<Proc:0x000000010709f5a8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x0000000107bdeae0 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x0000000107bdf148 @unit=:microsecond>>, [], nil], [Hanami::Middleware::BodyParser, [:json], nil], [Hanami::Middleware::BodyParser, [[{:json=>[]}]], nil]]}, @namespaces=[Hanami::Middleware]>, @name_prefix=#<Hanami::Router::Prefix:0x0000000107bdcc40 @prefix="">, @url_helpers=#<Hanami::Router::UrlHelpers:0x0000000107bdcbc8 @base_url=#<URI::HTTP http://0.0.0.0:2300>, @named={:root=>#<Mustermann::Rails:"/">}>, @base_url=#<URI::HTTP http://0.0.0.0:2300>, @resolver=#<Hanami::Slice::Routing::Resolver:0x0000000107bdd848 @slice=Bookshelf::App>, @not_found=#<Proc:0x00000001070176d0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:778 (lambda)>, @block_context=nil, @fixed={"GET"=>{"/"=>#<Proc:0x0000000107bdc5d8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x0000000107bff1a0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "HEAD"=>{"/"=>#<Proc:0x0000000107bed608 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>, "/books"=>#<Proc:0x0000000107bfefc0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}, "POST"=>{"/books"=>#<Proc:0x0000000107bfd0d0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>}}, @variable={"GET"=>#<Hanami::Router::Trie:0x0000000107bec730 @root=#<Hanami::Router::Node:0x0000000107bec690 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000107bec348 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000107bf4318 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000107bec7d0 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>, "books"=>#<Hanami::Router::Node:0x0000000107bfeb10 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000107bfe160 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000107bfecc8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>, "HEAD"=>#<Hanami::Router::Trie:0x0000000107bf4048 @root=#<Hanami::Router::Node:0x0000000107bf4020 @variable=nil, @fixed={"home"=>#<Hanami::Router::Node:0x0000000107bffe20 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000107bff498 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000107bf4070 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>, "books"=>#<Hanami::Router::Node:0x0000000107bfddc8 @variable={#<Mustermann::Rails:":id">=>#<Hanami::Router::Node:0x0000000107bfd440 @variable=nil, @fixed=nil, @to=#<Proc:0x0000000107bfdf80 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:73 (lambda)>>}, @fixed=nil, @to=nil>}, @to=nil>>}, @globbed={}, @mounted={}, @blk=#<Proc:0x0000000107075a00 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/routes.rb:73>, @inspector=nil>>, @rack_monitor=#<Dry::Monitor::Rack::Middleware:0x0000000107bdf0a8 @notifications=#<Dry::Monitor::Notifications:0x00000001070ff020 @id=:bookshelf, @clock=#<Dry::Monitor::Clock:0x00000001070ffae8 @unit=:millisecond>, @__bus__=#<Dry::Events::Bus:0x0000000107bde748 @listeners=#<Concurrent::Map:0x0000000107bde810 entries=3 default_proc=#<Proc:0x000000010709f5a8 /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-events-1.0.1/lib/dry/events/constants.rb:9>>, @events=#<Concurrent::Map:0x0000000107bdeae0 entries=3 default_proc=nil>>>, @app=nil, @clock=#<Dry::Monitor::Clock:0x0000000107bdf148 @unit=:microsecond>>, @config=#<Hanami::Action::Config values={:handled_exceptions=>{ROM::TupleCountMismatchError=>:handle_not_found}, :formats=>#<Hanami::Action::Config::Formats values=[:json] mapping={"application/octet-stream"=>:all, "*/*"=>:all}>, :default_charset=>nil, :default_headers=>{"X-Frame-Options"=>"DENY", "X-Content-Type-Options"=>"nosniff", "X-XSS-Protection"=>"1; mode=block", "Content-Security-Policy"=>"base-uri 'self';\nchild-src 'self';\nconnect-src 'self';\ndefault-src 'none';\nfont-src 'self';\nform-action 'self';\nframe-ancestors 'self';\nframe-src 'self';\nimg-src 'self' https: data:;\nmedia-src 'self';\nobject-src 'none';\nplugin-types application/pdf;\nscript-src 'self';\nstyle-src 'self' 'unsafe-inline' https:"}, :cookies=>{}, :root_directory=>#<Pathname:/Users/foxweb/work/bookshelf>, :public_directory=>"/Users/foxweb/work/bookshelf/public", :before_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00000001072dc168 @chain=[]>, :after_callbacks=>#<Hanami::Utils::Callbacks::Chain:0x00000001072d7e38 @chain=[]>}>>

          ap request.params
          ^^ (NoMethodError)
  /Users/foxweb/work/bookshelf/app/actions/books/create.rb:17:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:52:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:52:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `post'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `post'
  /Users/foxweb/work/bookshelf/spec/requests/books/create_spec.rb:24:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [INFO] [2022-11-29 02:06:07 +0300] POST 201 29ms 127.0.0.1 /books -
  {:book=>{:title=>"Practical Object-Oriented Design in Ruby", :author=>"Sandi Metz"}}
[bookshelf] [INFO] [2022-11-29 02:06:07 +0300] POST 422 3ms 127.0.0.1 /books -
  {:book=>{:title=>nil}}
[bookshelf] [INFO] [2022-11-29 02:06:07 +0300] GET 422 1ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-11-29 02:06:07 +0300] GET 200 1ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-11-29 02:06:07 +0300] GET 200 593µs 127.0.0.1 / -
[bookshelf] [INFO] [2022-11-29 02:06:07 +0300] GET 200 859µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-11-29 02:06:07 +0300] GET 200 3ms 127.0.0.1 /books/24 -
  {:id=>"24"}
[bookshelf] [ERROR] [2022-11-29 02:06:07 +0300] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /Users/foxweb/work/bookshelf/app/actions/books/show.rb:14:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [INFO] [2022-11-29 02:06:07 +0300] GET 404 7ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-11-29 02:06:24 +0300] GET 200 7ms 127.0.0.1 / -
[bookshelf] [INFO] [2022-11-29 02:06:24 +0300] POST 422 18ms 127.0.0.1 /books -
  {:book=>{:title=>nil}}
[bookshelf] [INFO] [2022-11-29 02:06:24 +0300] POST 201 3ms 127.0.0.1 /books -
  {:book=>{:title=>"Practical Object-Oriented Design in Ruby", :author=>"Sandi Metz"}}
[bookshelf] [INFO] [2022-11-29 02:06:24 +0300] GET 200 1ms 127.0.0.1 /books -
[bookshelf] [INFO] [2022-11-29 02:06:24 +0300] GET 200 1ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-11-29 02:06:24 +0300] GET 422 1ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-11-29 02:06:24 +0300] GET 200 2ms 127.0.0.1 /books/24 -
  {:id=>"24"}
[bookshelf] [ERROR] [2022-11-29 02:06:24 +0300] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /Users/foxweb/work/bookshelf/app/actions/books/show.rb:14:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [INFO] [2022-11-29 02:06:24 +0300] GET 404 1ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-11-29 02:09:33 +0300] GET 422 15ms 127.0.0.1 /books -
  {:page=>"-1", :per_page=>"3000"}
[bookshelf] [INFO] [2022-11-29 02:09:33 +0300] GET 200 1ms 127.0.0.1 /books -
  {:page=>"1", :per_page=>"3"}
[bookshelf] [INFO] [2022-11-29 02:09:33 +0300] GET 200 844µs 127.0.0.1 /books -
[bookshelf] [INFO] [2022-11-29 02:09:33 +0300] POST 422 2ms 127.0.0.1 /books -
  {:book=>{:title=>nil}}
[bookshelf] [INFO] [2022-11-29 02:09:33 +0300] POST 201 2ms 127.0.0.1 /books -
  {:book=>{:title=>"Practical Object-Oriented Design in Ruby", :author=>"Sandi Metz"}}
[bookshelf] [INFO] [2022-11-29 02:09:33 +0300] GET 200 765µs 127.0.0.1 / -
[bookshelf] [ERROR] [2022-11-29 02:09:33 +0300] GET 500 0µs 127.0.0.1 /books/1 -
  {:id=>"1"}
  The relation does not contain any tuples (ROM::TupleCountMismatchError)
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/loaded.rb:76:in `one!'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rom-core-5.3.0/lib/rom/relation/materializable.rb:49:in `one!'
  /Users/foxweb/work/bookshelf/app/actions/books/show.rb:14:in `handle'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:326:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `catch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-controller-2.0.0/lib/hanami/action.rb:307:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice/routing/resolver.rb:78:in `block in resolve_slice_action'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/router.rb:108:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/body_parser.rb:43:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `block in call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/clock.rb:15:in `measure'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/dry-monitor-1.0.1/lib/dry/monitor/rack/middleware.rb:36:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-router-2.0.0/lib/hanami/middleware/app.rb:40:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/hanami-2.0.0/lib/hanami/slice.rb:758:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:358:in `process_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:165:in `custom_request'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rack-test-2.0.2/lib/rack/test.rb:114:in `get'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `get'
  /Users/foxweb/work/bookshelf/spec/requests/books/show_spec.rb:25:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:263:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `block in with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `block in with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:626:in `block in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:14:in `block (3 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/strategy.rb:30:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:34:in `block (2 levels) in cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/database_cleaner-core-2.0.1/lib/database_cleaner/cleaners.rb:35:in `cleaning'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/3.1.0/forwardable.rb:238:in `cleaning'
  /Users/foxweb/work/bookshelf/spec/support/database_cleaner.rb:13:in `block (2 levels) in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:457:in `instance_exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:390:in `execute_with'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:628:in `block (2 levels) in run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:352:in `call'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:629:in `run_around_example_hooks_for'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/hooks.rb:486:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:468:in `with_around_example_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:511:in `with_around_and_singleton_context_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example.rb:259:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:646:in `block in run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:642:in `run_examples'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:607:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `block in run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/example_group.rb:608:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `map'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/configuration.rb:2070:in `with_suite_hooks'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:116:in `block in run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/reporter.rb:74:in `report'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:115:in `run_specs'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:89:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:71:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/lib/rspec/core/runner.rb:45:in `invoke'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/rspec-core-3.12.0/exe/rspec:4:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/rspec:25:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:58:in `kernel_load'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli/exec.rb:23:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:486:in `exec'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/invocation.rb:127:in `invoke_command'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor.rb:392:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:31:in `dispatch'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/vendor/thor/lib/thor/base.rb:485:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/cli.rb:25:in `start'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:48:in `block in <top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/lib/bundler/friendly_errors.rb:120:in `with_friendly_errors'
  /Users/foxweb/.rbenv/versions/3.1.2/lib/ruby/gems/3.1.0/gems/bundler-2.3.26/exe/bundle:36:in `<top (required)>'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `load'
  /Users/foxweb/.rbenv/versions/3.1.2/bin/bundle:25:in `<main>'
[bookshelf] [INFO] [2022-11-29 02:09:33 +0300] GET 404 3ms 127.0.0.1 /books/1 -
  {:id=>"1"}
[bookshelf] [INFO] [2022-11-29 02:09:33 +0300] GET 200 720µs 127.0.0.1 /books/24 -
  {:id=>"24"}
